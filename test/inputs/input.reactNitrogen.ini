[solver]
type = loMach

[loMach]
mesh = meshes/periodic-square.mesh
order = 2
maxIters = 100
#maxIters = 1000
outputFreq = 100
fluid = 'user_defined'
enablePressureForcing = false
pressureGrad = '0.0 0.0 0.0'
enableGravity = false
gravity = '0.0 0.0 0.0'
openSystem = True
ambientPressure = 101300.
flow-solver = tomboulides
#flow-solver = zero-flow
thermo-solver = reacting-flow

[loMach/tomboulides]
linear-solver-rtol = 1.0e-12
linear-solver-max-iter = 1000

[loMach/reactingFlow]
linear-solver-rtol = 1.0e-12
linear-solver-max-iter = 2000
initialTemperature = 5000.0
sub-steps = 2
#dynamic-substep = true
#dynamic-fraction = 10000.0
#sub-steps = 1
#implicit-chemistry = true

[io]
outdirBase = output
enableRestart = false
#enableRestart = True

[time]
integrator = curlcurl
dt_fixed = 1.0e-7
bdfOrder = 1

[spongeMultiplier]
uniform = true
uniformMult = 99000.

[initialConditions]
temperature = 5000.0

[boundaryConditions]
numWalls = 0
numInlets = 0
numOutlets = 0

###########################################
#        PLASMA MODELS
###########################################
[plasma_models]
gas = nitrogen
ambipolar = False
two_temperature = False
gas_model = perfect_mixture
#transport_model = constant
transport_model = gas_mixture
chemistry_model = 'mass_action_law'
species_number = 7

#[plasma_models/transport_model/constant]
#viscosity = 0.0
#bulk_viscosity = 0.0
#thermal_conductivity = 0.0
#electron_thermal_conductivity = 0.0
#diffusivity/species1 = 0.0
#diffusivity/species2 = 0.0
#diffusivity/species3 = 0.0
#diffusivity/species4 = 0.0
#diffusivity/species5 = 0.0
#diffusivity/species6 = 0.0
#diffusivity/species7 = 0.0
#momentum_transfer_frequency/species1 = 0.0
#momentum_transfer_frequency/species2 = 0.0
#momentum_transfer_frequency/species3 = 0.0
#momentum_transfer_frequency/species4 = 0.0
#momentum_transfer_frequency/species5 = 0.0
#momentum_transfer_frequency/species6 = 0.0
#momentum_transfer_frequency/species7 = 0.0

[atoms]
numAtoms = 2

[atoms/atom1]
name = 'Ni'
mass = 0.01401 # [kg/mol]

[atoms/atom2]
name = 'E'
mass = 5.48579908782496e-7 # [kg/mol]

[species]
numSpecies = 7
background_index = 7

# if gas_model is perfect_mixture, requires heat capacities from input.
# molar heat capacities in unit of universal gas constant.

# NOTE: ratio of mass N/e = 25532.650469, initial ions and e must
# be consistent with this
# e.g. if E_imf = 1e-12, (N2+ + N+)_imf = 2.55326505e-8
# if same moles, N2+_imf = 1.7021767e-8
# and N+_imf = 8.51088349e-9

[species/species7]
name = 'N2'
composition = '{Ni : 2}'
formation_energy = 0.0
level_degeneracy = 1
initialMassFraction = 0.1657
perfect_mixture/constant_molar_cv = 2.5 # normalized by universal gas const
perfect_mixture/constant_molar_cp = 3.5

[species/species6]
name = 'E'
composition = '{E : 1}'
formation_energy = 0.0
level_degeneracy = 1
initialMassFraction = 8.230912717895867e-08
initialElectronTemperature = 5000.0
perfect_mixture/constant_molar_cv = 2.5
perfect_mixture/constant_molar_cp = 3.5

[species/species5]
name = 'N2.+1'
composition = '{Ni : 2, E : -1}'
formation_energy = 1503459.1158  # [J/mol]  -> Ionization energy (eV) * 1.60218e-19 (J/e) * 6.023e23 (avagadro)
level_degeneracy = 1 
initialMassFraction = 1.267645653840009e-04
perfect_mixture/constant_molar_cv = 2.5
perfect_mixture/constant_molar_cp = 3.5

[species/species4]
name = 'N2_e'
composition = '{Ni : 2}'
formation_energy = 812408.331926
level_degeneracy = 1 # number of lumped states or true degen?
initialMassFraction = 2e-12
perfect_mixture/constant_molar_cv = 2.5
perfect_mixture/constant_molar_cp = 3.5

[species/species3]
name = 'Ni'
composition = '{Ni : 1}'
formation_energy = 470723.5922
level_degeneracy = 4
initialMassFraction = 0.8322
perfect_mixture/constant_molar_cv = 1.5
perfect_mixture/constant_molar_cp = 2.5

[species/species2]
name = 'Ni.+1'
composition = '{Ni : 1, E : -1}'
formation_energy = 1873823.43223
level_degeneracy = 4
initialMassFraction = 0.002038106614867
perfect_mixture/constant_molar_cv = 1.5
perfect_mixture/constant_molar_cp = 2.5

[species/species1]
name = 'Ni_e'
composition = '{Ni : 1}'
formation_energy = 758424.8665
level_degeneracy = 4
initialMassFraction = 1e-12
perfect_mixture/constant_molar_cv = 1.5
perfect_mixture/constant_molar_cp = 2.5

# Species ordering (N2vib removed, all N2 are lumped vib and rot)
# [N*, N+, N, N2*, N2+, e, N2]

[reactions]
#number_of_reactions = 4
#number_of_reactions = 10
#number_of_reactions = 14
number_of_reactions = 18

# ordering of reactions (by reactants)
# N2-N2  (1-2)   (dissociation)
# N-N2   (3-4)   (dissociation)
# N-e    (5-6)   (ionization)
# N2-e   (7-10)  (ionization and dissociation)
# N-e    (11-12) (excitation)
# N*-e   (13-14) (ionization)
# N2-e   (15-16) (excitation)
# N2*-e  (17-18) (ionization)

# [N*, N+, N, N2*, N2+, e, N2]

# dissociations via heavies impact
[reactions/reaction1]
equation = '2 N2 => 2 Ni + N2'
reaction_energy = 941447.18445
reactant_stoichiometry = '0 0 0 0 0 0 2'
product_stoichiometry  = '0 0 2 0 0 0 1'
model = tabulated
tabulated/filename = 'inputs/rate-coefficients-nitrogen/dissN2N2Forward.h5'
tabulated/x_log = False
tabulated/f_log = False
tabulated/order = 1
detailed_balance = False

[reactions/reaction2]
equation = '2 Ni + N2 => 2 N2'
reaction_energy = -941447.18445
reactant_stoichiometry = '0 0 2 0 0 0 1'
product_stoichiometry  = '0 0 0 0 0 0 2'
model = tabulated
tabulated/filename = 'inputs/rate-coefficients-nitrogen/dissN2N2Forward.h5'
tabulated/x_log = False
tabulated/f_log = False
tabulated/order = 1
detailed_balance = False

[reactions/reaction3]
equation = 'N2 + Ni => 3 Ni'
reaction_energy = 941447.18445
reactant_stoichiometry = '0 0 1 0 0 0 1'
product_stoichiometry  = '0 0 3 0 0 0 0'
model = tabulated
tabulated/filename = 'inputs/rate-coefficients-nitrogen/dissNN2Forward.h5'
tabulated/x_log = False
tabulated/f_log = False
tabulated/order = 1
detailed_balance = False

[reactions/reaction4]
equation = '3 Ni => N2 + Ni'
reaction_energy = -941447.18445
reactant_stoichiometry = '0 0 3 0 0 0 0'
product_stoichiometry  = '0 0 1 0 0 0 1'
model = tabulated
tabulated/filename = 'inputs/rate-coefficients-nitrogen/dissNN2Backward.h5'
tabulated/x_log = False
tabulated/f_log = False
tabulated/order = 1
detailed_balance = False

# atomic nitrogen-electron ionization
[reactions/reaction5]
equation = 'Ni + E => Ni.+1 + 2 E'
reaction_energy = 1403099.8424
reactant_stoichiometry = '0 0 1 0 0 1 0'
product_stoichiometry  = '0 1 0 0 0 2 0'
model = tabulated
tabulated/filename = 'inputs/rate-coefficients-nitrogen/ionizationENForward.h5'
tabulated/x_log = False
tabulated/f_log = False
tabulated/order = 1
detailed_balance = False

[reactions/reaction6]
equation = 'Ni.+1 + 2 E => Ni + E'
reaction_energy = -1403099.8423
reactant_stoichiometry = '0 1 0 0 0 2 0'
product_stoichiometry  = '0 0 1 0 0 1 0'
model = tabulated
tabulated/filename = 'inputs/rate-coefficients-nitrogen/ionizationENBackward.h5'
tabulated/x_log = False
tabulated/f_log = False
tabulated/order = 1
detailed_balance = False

# N2-electron ionization
[reactions/reaction7]
equation = 'N2 + E => N2.+1 + 2 E'
reaction_energy = 1503459.1158 # [J/mol]
reactant_stoichiometry = '0 0 0 0 0 1 1'
product_stoichiometry  = '0 0 0 0 1 2 0'
model = tabulated
tabulated/filename = 'inputs/rate-coefficients-nitrogen/ionizationEN2Forward.h5'
tabulated/x_log = False
tabulated/f_log = False
tabulated/order = 1
detailed_balance = False

[reactions/reaction8]
equation = 'N2.+1 + 2 E => N2 + E'
reaction_energy = -1503459.1158
reactant_stoichiometry = '0 0 0 0 1 2 0'
product_stoichiometry  = '0 0 0 0 0 1 1'
model = tabulated
tabulated/filename = 'inputs/rate-coefficients-nitrogen/ionizationEN2Backward.h5'
tabulated/x_log = False
tabulated/f_log = False
tabulated/order = 1
detailed_balance = False

# electron-impact dissociation
# sans "vib" uses itikawa data which ambigously claims "total" dissociation
# "vib" uses laporta but there me must extrapolate j>0 cross-sections
[reactions/reaction9]
equation = 'N2 + E => 2 Ni + E'
reaction_energy = 941447.18446
reactant_stoichiometry = '0 0 0 0 0 1 1'
product_stoichiometry  = '0 0 2 0 0 1 0'
model = tabulated
#tabulated/filename = 'rate-coefficients/dissEN2forward.h5'
tabulated/filename = 'inputs/rate-coefficients-nitrogen/dissEN2vibForward.h5'
tabulated/x_log = False
tabulated/f_log = False
tabulated/order = 1
detailed_balance = False

[reactions/reaction10]
equation = '2 Ni + E => N2 + E'
reaction_energy = -941447.18445
reactant_stoichiometry = '0 0 2 0 0 1 0'
product_stoichiometry  = '0 0 0 0 0 1 1'
model = tabulated
#tabulated/filename = 'rate-coefficients/dissEN2backward.h5'
tabulated/filename = 'inputs/rate-coefficients-nitrogen/dissEN2vibBackward.h5'
tabulated/x_log = False
tabulated/f_log = False
tabulated/order = 1
detailed_balance = False

# atomic nitrogen excitation
[reactions/reaction11]
equation = 'Ni + E => Ni_e + E'
reaction_energy = 287701.274284
reactant_stoichiometry = '0 0 1 0 0 1 0'
product_stoichiometry  = '1 0 0 0 0 1 0'
model = tabulated
tabulated/filename = 'inputs/rate-coefficients-nitrogen/excitationENForward.h5'
tabulated/x_log = False
tabulated/f_log = False
tabulated/order = 1
detailed_balance = False

[reactions/reaction12]
equation = 'Ni_e + E => Ni + E'
reaction_energy = -287701.274284
reactant_stoichiometry = '1 0 0 0 0 1 0'
product_stoichiometry  = '0 0 1 0 0 1 0'
model = tabulated
tabulated/filename = 'inputs/rate-coefficients-nitrogen/excitationENBackward.h5'
tabulated/x_log = False
tabulated/f_log = False
tabulated/order = 1
detailed_balance = False

# [N*, N+, N, N2*, N2+, e, N2]

# pair causing delayed rapid changes in Yn's
# w/o this one, N* cannot not move up to N+
[reactions/reaction13]
equation = 'Ni_e + E => Ni.+1 + 2 E'
reaction_energy = 1115398.56802
reactant_stoichiometry = '1 0 0 0 0 1 0'
product_stoichiometry  = '0 1 0 0 0 2 0'
model = tabulated
tabulated/filename = 'inputs/rate-coefficients-nitrogen/ionizationENstarForward.h5'
#tabulated/filename = 'rate-coefficients/ionizationENForward.h5'
tabulated/x_log = False
tabulated/f_log = False
tabulated/order = 1
detailed_balance = False

[reactions/reaction14]
equation = 'Ni.+1 + 2 E => Ni_e + E'
reaction_energy = -1115398.56802
reactant_stoichiometry = '0 1 0 0 0 2 0'
product_stoichiometry  = '1 0 0 0 0 1 0'
model = tabulated
tabulated/filename = 'inputs/rate-coefficients-nitrogen/ionizationENstarBackward.h5'
#tabulated/filename = 'rate-coefficients/ionizationENBackward.h5'
tabulated/x_log = False
tabulated/f_log = False
tabulated/order = 1
detailed_balance = False

# electronic excitation 
[reactions/reaction15]
equation = 'N2 + E => N2_e + E'
reaction_energy = 812408.331926
reactant_stoichiometry = '0 0 0 0 0 1 1'
product_stoichiometry  = '0 0 0 1 0 1 0'
model = tabulated
tabulated/filename = 'inputs/rate-coefficients-nitrogen/excitationEN2Forward.h5'
tabulated/x_log = False
tabulated/f_log = False
tabulated/order = 1
detailed_balance = False

[reactions/reaction16]
equation = 'N2_e + E => N2 + E'
reaction_energy = -812408.331926
reactant_stoichiometry = '0 0 0 1 0 1 0'
product_stoichiometry  = '0 0 0 0 0 1 1'
model = tabulated
tabulated/filename = 'inputs/rate-coefficients-nitrogen/excitationEN2Backward.h5'
tabulated/x_log = False
tabulated/f_log = False
tabulated/order = 1
detailed_balance = False

# electronically excited to ionization
[reactions/reaction17]
equation = 'N2_e + E => N2.+1 + 2 E'
reaction_energy = 691050.783874
reactant_stoichiometry = '0 0 0 1 0 1 0'
product_stoichiometry  = '0 0 0 0 1 2 0'
model = tabulated
tabulated/filename = 'inputs/rate-coefficients-nitrogen/ionizationEN2starForward.h5'
tabulated/x_log = False
tabulated/f_log = False
tabulated/order = 1
detailed_balance = False

[reactions/reaction18]
equation = 'N2.+1 + 2 E => N2_e + E'
reaction_energy = -691050.783874
reactant_stoichiometry = '0 0 0 0 1 2 0'
product_stoichiometry  = '0 0 0 1 0 1 0'
model = tabulated
tabulated/filename = 'inputs/rate-coefficients-nitrogen/ionizationEN2starBackward.h5'
tabulated/x_log = False
tabulated/f_log = False
tabulated/order = 1
detailed_balance = False


# dissociations via electron impact of excited N2
# valid reaction, but at temps were N2* (or N2+) are non-negligible,
# N2 will have mostly dissociated already, i.e. probably not worth it
[reactions/reactionMMM]
equation = 'N2_e + E => 2 Ni + E'
reaction_energy = 129038.8525
reactant_stoichiometry = '0 0 0 0 1 0 1 0'
product_stoichiometry  = '0 0 2 0 0 0 1 0'
model = tabulated
tabulated/filename = 'inputs/rate-coefficients-nitrogen/dissEN2starForward.h5'
tabulated/x_log = False
tabulated/f_log = False
tabulated/order = 1
detailed_balance = False

[reactions/reactionMMM]
equation = '2 Ni + E => N2_e + E'
reaction_energy = -129038.8525
reactant_stoichiometry = '0 0 2 0 0 0 1 0'
product_stoichiometry  = '0 0 0 0 1 0 1 0'
model = tabulated
tabulated/filename = 'inputs/rate-coefficients-nitrogen/dissEN2starBackward.h5'
tabulated/x_log = False
tabulated/f_log = False
tabulated/order = 1
detailed_balance = False

